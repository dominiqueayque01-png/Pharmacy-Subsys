<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>Sales Reports - Well Served</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,typography"></script>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"/>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        primary: "#005a32",
                        secondary: "#d62828",
                        accent: "#8b5a2b",
                        "background-light": "#f1f5f9",
                        "background-dark": "#0f172a",
                        "surface-light": "#FFFFFF",
                        "surface-dark": "#1F2937",
                        "text-light": "#1F2937",
                        "text-dark": "#F9FAFB",
                        "subtext-light": "#6B7280",
                        "subtext-dark": "#9CA3AF",
                        "border-light": "#E5E7EB",
                        "border-dark": "#374151",
                        "success": "#22C55E",
                        "warning": "#F59E0B",
                        "danger": "#EF4444"
                    },
                    fontFamily: { sans: ['Inter', 'sans-serif'] },
                },
            },
        };
    </script>
    <style>
        body { font-family: 'Inter', sans-serif; }
        .drag-region { -webkit-app-region: drag; }
        .no-drag     { -webkit-app-region: no-drag; }
        .hidden { display: none !important; }

        /* ── NOTIFICATION DROPDOWN ── */
        @keyframes badge-pop { from { transform: scale(0); } to { transform: scale(1); } }
        #notificationBadge { animation: badge-pop 0.3s cubic-bezier(.34,1.56,.64,1); }

        .notif-dropdown {
            position: absolute; top: calc(100% + 10px); right: 0; width: 370px;
            background: #fff; border-radius: 14px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.14), 0 4px 12px rgba(0,0,0,0.06);
            border: 1px solid #e5e7eb; z-index: 1000; overflow: hidden;
            opacity: 0; transform: translateY(-8px) scale(0.97); pointer-events: none;
            transition: opacity 0.22s ease, transform 0.22s cubic-bezier(.34,1.56,.64,1);
            transform-origin: top right;
        }
        .dark .notif-dropdown { background: #1F2937; border-color: #374151; }
        .notif-dropdown.open { opacity: 1; transform: translateY(0) scale(1); pointer-events: all; }

        .notif-header { display: flex; align-items: center; justify-content: space-between; padding: 16px 18px 14px; border-bottom: 1px solid #f0f0f0; }
        .dark .notif-header { border-color: #374151; }
        .notif-header h3 { font-size: 15px; font-weight: 700; color: #111827; }
        .dark .notif-header h3 { color: #F9FAFB; }
        .notif-header-meta { display: flex; align-items: center; gap: 10px; }
        .unread-count-pill { background: #005a32; color: #fff; font-size: 10px; font-weight: 700; padding: 2px 8px; border-radius: 99px; }
        .mark-all-btn { font-size: 11px; color: #005a32; font-weight: 600; background: none; border: none; cursor: pointer; padding: 2px 4px; border-radius: 4px; transition: background 0.15s; }
        .mark-all-btn:hover { background: #f0fdf4; }

        .notif-tabs { display: flex; gap: 4px; padding: 10px 14px; background: #fafafa; border-bottom: 1px solid #f0f0f0; }
        .dark .notif-tabs { background: #111827; border-color: #374151; }
        .notif-tab-btn { font-size: 11px; font-weight: 600; padding: 4px 10px; border-radius: 99px; border: 1px solid transparent; cursor: pointer; background: none; color: #6b7280; transition: all 0.15s; }
        .notif-tab-btn.active { background: #005a32; color: #fff; border-color: #005a32; }
        .notif-tab-btn:not(.active):hover { background: #f3f4f6; border-color: #e5e7eb; color: #374151; }

        .notif-list { max-height: 360px; overflow-y: auto; scrollbar-width: thin; scrollbar-color: #e5e7eb transparent; }
        .notif-list::-webkit-scrollbar { width: 4px; }
        .notif-list::-webkit-scrollbar-thumb { background: #e5e7eb; border-radius: 2px; }

        .notif-item { display: flex; gap: 12px; align-items: flex-start; padding: 13px 16px; border-bottom: 1px solid #f5f5f5; cursor: pointer; position: relative; transition: background 0.15s; }
        .dark .notif-item { border-color: #374151; }
        .notif-item:last-child { border-bottom: none; }
        .notif-item:hover { background: #f9fafb; }
        .dark .notif-item:hover { background: #111827; }
        .notif-item.unread { background: #ffffff; }
        .notif-item::before { content: ''; position: absolute; left: 0; top: 0; bottom: 0; width: 3px; border-radius: 0 2px 2px 0; }
        .notif-item.critical::before { background: #EF4444; }
        .notif-item.expiry::before   { background: #8b5a2b; }
        .notif-item.pending::before  { background: #3B82F6; }
        .notif-item.shortage::before { background: #358E83; }

        .notif-icon-wrap { flex-shrink: 0; width: 38px; height: 38px; border-radius: 10px; display: flex; align-items: center; justify-content: center; }
        .notif-icon-wrap .material-icons { font-size: 20px; }
        .icon-critical { background: #fef2f2; } .icon-critical .material-icons { color: #EF4444; }
        .icon-expiry   { background: #fdf6ec; } .icon-expiry   .material-icons { color: #8b5a2b; }
        .icon-pending  { background: #eff6ff; } .icon-pending  .material-icons { color: #3B82F6; }
        .icon-shortage { background: #f0fdfa; } .icon-shortage .material-icons { color: #358E83; }

        .notif-body { flex: 1; min-width: 0; }
        .notif-title { font-size: 13px; font-weight: 600; color: #111827; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .dark .notif-title { color: #F9FAFB; }
        .notif-desc  { font-size: 12px; color: #6b7280; margin-top: 2px; line-height: 1.4; }
        .notif-time  { font-size: 10px; color: #9ca3af; margin-top: 6px; }
        .notif-action { margin-top: 8px; }
        .notif-action-btn { display: inline-flex; align-items: center; gap: 4px; font-size: 11px; font-weight: 700; padding: 5px 12px; border-radius: 6px; border: none; cursor: pointer; text-transform: uppercase; letter-spacing: 0.04em; transition: opacity 0.15s, transform 0.1s; }
        .notif-action-btn:active { transform: scale(0.96); }
        .notif-action-btn:hover  { opacity: 0.88; }
        .btn-critical { background: #EF4444; color: #fff; }
        .btn-expiry   { background: #8b5a2b; color: #fff; }
        .btn-pending  { background: #3B82F6; color: #fff; }
        .btn-shortage { background: #005a32; color: #fff; }

        .unread-dot { flex-shrink: 0; width: 7px; height: 7px; border-radius: 50%; background: #005a32; margin-top: 5px; }
        .notif-empty { padding: 40px 20px; text-align: center; color: #9ca3af; }
        .notif-empty .material-icons { font-size: 40px; margin-bottom: 8px; display: block; }
        .notif-empty p { font-size: 13px; }
        .notif-footer { border-top: 1px solid #f0f0f0; padding: 12px 18px; display: flex; align-items: center; justify-content: space-between; }
        .dark .notif-footer { border-color: #374151; }
        .view-all-link { font-size: 12px; font-weight: 600; color: #005a32; text-decoration: none; display: flex; align-items: center; gap: 4px; }
        .view-all-link:hover { text-decoration: underline; }
        .view-all-link .material-icons { font-size: 14px; }
        .notif-settings-btn { font-size: 11px; color: #9ca3af; background: none; border: none; cursor: pointer; display: flex; align-items: center; gap: 3px; }
        .notif-settings-btn:hover { color: #6b7280; }

        .export-options {
            display: none; position: absolute; top: 100%; right: 0; width: 150px;
            background: white; border: 1px solid #e5e7eb; border-radius: 0.5rem;
            box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1); z-index: 1000; margin-top: 0.5rem;
        }
        .export-option {
            padding: 0.75rem 1rem; cursor: pointer; border-bottom: 1px solid #f3f4f6;
            display: flex; align-items: center; gap: 0.5rem; font-size: 14px;
        }
        .export-option:hover { background-color: #f9fafb; }
        .export-option:last-child { border-bottom: none; }

        /* ── SIDEBAR LOGOUT BUTTON ── */
        .sidebar-logout-btn {
            display: flex; align-items: center; gap: 10px;
            width: 100%; padding: 10px 16px; border: none;
            background: none; cursor: pointer; border-radius: 8px;
            color: #d62828; font-size: 14px; font-weight: 600;
            transition: background 0.15s; text-align: left;
        }
        .sidebar-logout-btn:hover { background: #fef2f2; }
        .sidebar-logout-btn .material-icons { font-size: 20px; color: #d62828; }
    </style>
</head>
<body class="bg-background-light dark:bg-background-dark font-sans">

    <!-- ── TITLE BAR ── -->
    <div id="title-bar" class="drag-region fixed top-0 left-0 w-full h-8 bg-white flex justify-between items-stretch z-40 border-b border-gray-200 select-none">
        <div class="flex items-center pl-4 gap-2 text-gray-600">
            <span class="text-xs font-semibold">IHMS Pharmacy</span>
        </div>
        <div class="no-drag flex items-center relative z-50">
            <button id="min-btn" class="h-full w-12 flex justify-center items-center hover:bg-gray-200 transition-colors duration-200">
                <span class="material-icons-outlined text-sm text-gray-600">remove</span>
            </button>
            <button id="max-btn" class="h-full w-12 flex justify-center items-center hover:bg-gray-200 transition-colors duration-200">
                <span class="material-icons-outlined text-sm text-gray-600" id="maxIcon">crop_square</span>
            </button>
            <button id="close-btn" class="h-full w-12 flex justify-center items-center hover:bg-red-500 transition-colors duration-200 group">
                <span class="material-icons-outlined text-sm text-gray-600 group-hover:text-white">close</span>
            </button>
        </div>
    </div>

    <div class="flex h-screen pt-8">

        <!-- ── SIDEBAR ── -->
        <aside class="w-64 bg-surface-light dark:bg-surface-dark flex flex-col border-r border-slate-200 dark:border-slate-800 flex-shrink-0">
            <!-- Logo -->
           <div class="h-16 flex items-center gap-3 px-4 border-b border-border-light dark:border-border-dark">

    <img
      src="images/wellserved.png"
      alt="Well Served Logo"
      class="w-12 h-12 rounded-full object-cover border border-slate-100 dark:border-slate-700 shadow-sm"
    />
    <div>
        <h1 class="font-bold text-primary dark:text-green-400 leading-tight">
            Well Served
        </h1>
        <p class="text-[10px] uppercase tracking-wider text-accent dark:text-amber-600 font-semibold">
            Since 1994
        </p>
    </div>
</div>

            <!-- Nav Links -->
            <nav class="flex-1 px-4 py-6 space-y-2">
                <div class="px-2 text-sm font-semibold text-subtext-light dark:text-subtext-dark mb-2">Admin Panel</div>
                <a class="flex items-center px-4 py-2 text-gray-700 dark:text-gray-300 rounded-md hover:bg-slate-50 dark:hover:bg-slate-700" href="dashboard_admin.html">
                    <span class="material-icons mr-3">dashboard</span> Dashboard
                </a>
                <a class="flex items-center px-4 py-2 text-gray-700 dark:text-gray-300 rounded-md hover:bg-slate-50 dark:hover:bg-slate-700" href="inventory_admin.html">
                    <span class="material-icons mr-3">inventory_2</span> Inventory
                </a>
                <a class="flex items-center px-4 py-2 bg-primary/10 text-primary rounded-md font-semibold" href="sales-reports.html">
                    <span class="material-icons mr-3">analytics</span> Sales Reports
                </a>
                <a class="flex items-center px-4 py-2 text-gray-700 dark:text-gray-300 rounded-md hover:bg-slate-50 dark:hover:bg-slate-700" href="patient_records.html">
                    <span class="material-icons mr-3">medical_services</span> Patient Records
                </a>
                <a class="flex items-center px-4 py-2 text-gray-700 dark:text-gray-300 rounded-md hover:bg-slate-50 dark:hover:bg-slate-700" href="medication_alerts.html">
                    <span class="material-icons mr-3">notifications</span> Medication Alerts
                </a>
                <a class="flex items-center px-4 py-2 text-gray-700 dark:text-gray-300 rounded-md hover:bg-slate-50 dark:hover:bg-slate-700" href="user_management.html">
                    <span class="material-icons mr-3">group</span> User Management
                </a>
            </nav>

            <!-- ── LOGOUT at bottom of sidebar ── -->
            <div class="px-4 pb-6 border-t border-slate-200 dark:border-slate-800 pt-4">
                <button onclick="logoutUser()" class="sidebar-logout-btn">
                    <span class="material-icons">logout</span>
                    Logout
                </button>
            </div>
        </aside>

        <!-- ── RIGHT COLUMN ── -->
        <div class="flex-1 flex flex-col overflow-hidden">

            <!-- ── APP HEADER (with full notification dropdown) ── -->
            <header class="h-16 bg-surface-light dark:bg-surface-dark flex items-center justify-between px-6 border-b border-slate-200 dark:border-slate-800 flex-shrink-0">
                <button onclick="confirmBackToHMS(event)" class="flex items-center gap-1 text-sm text-subtext-light hover:text-primary transition-colors">
                    <span class="material-icons">arrow_back_ios_new</span> Back to IHMS
                </button>

                <div class="flex items-center gap-4">
                    <!-- Notification Bell with Full Dropdown -->
                    <div class="relative">
                        <button id="notificationBtn"
                            class="relative text-subtext-light dark:text-subtext-dark hover:text-text-light dark:hover:text-text-dark p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                            <span class="material-icons text-2xl">notifications</span>
                            <span id="notificationBadge"
                                class="absolute -top-1 -right-1 h-5 w-5 rounded-full bg-red-500 text-white text-xs flex items-center justify-center font-bold">4</span>
                        </button>

                        <div id="notificationDropdown" class="notif-dropdown">
                            <div class="notif-header">
                                <h3>Notifications</h3>
                                <div class="notif-header-meta">
                                    <span class="unread-count-pill" id="unreadPill">4 new</span>
                                    <button class="mark-all-btn" onclick="markAllRead()">Mark all read</button>
                                </div>
                            </div>
                            <div class="notif-tabs">
                                <button class="notif-tab-btn active" onclick="filterNotifTab(this,'all')">All</button>
                                <button class="notif-tab-btn" onclick="filterNotifTab(this,'critical')">Critical</button>
                                <button class="notif-tab-btn" onclick="filterNotifTab(this,'expiry')">Expiry</button>
                                <button class="notif-tab-btn" onclick="filterNotifTab(this,'shortage')">Stock</button>
                                <button class="notif-tab-btn" onclick="filterNotifTab(this,'pending')">Pending</button>
                            </div>
                            <div class="notif-list" id="notifList"></div>
                            <div class="notif-footer">
                                <a href="medication_alerts.html" class="view-all-link">
                                    View all alerts <span class="material-icons">arrow_forward</span>
                                </a>
                                <button class="notif-settings-btn">
                                    <span class="material-icons">settings</span> Settings
                                </button>
                            </div>
                        </div>
                    </div>
                    <!-- Avatar -->
                    <div class="w-10 h-10 rounded-full bg-primary flex items-center justify-center text-white font-bold">AD</div>
                </div>
            </header>

            <!-- ── SCROLLABLE PAGE BODY ── -->
            <main class="flex-1 overflow-y-auto p-8">

                <div class="flex items-center justify-between mb-8">
                    <div>
                        <h2 class="text-3xl font-bold text-text-light dark:text-text-dark">Sales Reports & Analytics</h2>
                        <p class="text-subtext-light dark:text-subtext-dark mt-1">Comprehensive sales performance insights</p>
                    </div>
                    <div class="flex items-center gap-2">
                        <select id="timeRange" class="bg-background-light dark:bg-background-dark border border-slate-200 dark:border-slate-700 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-primary">
                            <option value="7">Last 7 days</option>
                            <option value="30" selected>Last 30 days</option>
                            <option value="90">Last 3 months</option>
                            <option value="365">Last year</option>
                        </select>
                        <div class="relative">
                            <button id="exportBtn" class="flex items-center gap-1 bg-primary text-white px-4 py-2 rounded-lg text-sm font-semibold hover:bg-primary/90 transition-colors">
                                <span class="material-icons text-sm">download</span>
                                Export
                                <span class="material-icons text-sm">arrow_drop_down</span>
                            </button>
                            <div id="exportOptions" class="export-options">
                                <div class="export-option" onclick="exportReport('pdf')"><span class="material-icons text-sm">picture_as_pdf</span> PDF</div>
                                <div class="export-option" onclick="exportReport('excel')"><span class="material-icons text-sm">table_chart</span> Excel</div>
                                <div class="export-option" onclick="exportReport('csv')"><span class="material-icons text-sm">grid_on</span> CSV</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- STAT CARDS -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <div class="bg-surface-light dark:bg-surface-dark p-6 rounded-xl border border-slate-200 dark:border-slate-800">
                        <div class="flex items-start justify-between">
                            <div>
                                <p class="text-sm text-subtext-light font-medium mb-1">TOTAL REVENUE</p>
                                <p class="text-4xl font-bold text-text-light dark:text-text-dark" id="totalRevenue">₱0.00</p>
                                <div class="flex items-center mt-2 text-sm"><span id="revenueGrowth" class="text-green-600">-</span></div>
                            </div>
                            <div class="p-3 bg-green-100 rounded-lg"><span class="material-icons text-green-600" style="font-size:28px;">payments</span></div>
                        </div>
                    </div>
                    <div class="bg-surface-light dark:bg-surface-dark p-6 rounded-xl border border-slate-200 dark:border-slate-800">
                        <div class="flex items-start justify-between">
                            <div>
                                <p class="text-sm text-subtext-light font-medium mb-1">TOTAL TRANSACTIONS</p>
                                <p class="text-4xl font-bold text-text-light dark:text-text-dark" id="totalTransactions">0</p>
                                <div class="flex items-center mt-2 text-sm"><span id="transactionsGrowth" class="text-blue-600">-</span></div>
                            </div>
                            <div class="p-3 bg-blue-100 rounded-lg"><span class="material-icons text-blue-600" style="font-size:28px;">receipt</span></div>
                        </div>
                    </div>
                    <div class="bg-surface-light dark:bg-surface-dark p-6 rounded-xl border border-slate-200 dark:border-slate-800">
                        <div class="flex items-start justify-between">
                            <div>
                                <p class="text-sm text-subtext-light font-medium mb-1">AVERAGE ORDER VALUE</p>
                                <p class="text-4xl font-bold text-text-light dark:text-text-dark" id="avgOrderValue">₱0.00</p>
                                <div class="flex items-center mt-2 text-sm"><span id="avgOrderGrowth" class="text-purple-600">-</span></div>
                            </div>
                            <div class="p-3 bg-purple-100 rounded-lg"><span class="material-icons text-purple-600" style="font-size:28px;">trending_up</span></div>
                        </div>
                    </div>
                    <div class="bg-surface-light dark:bg-surface-dark p-6 rounded-xl border border-slate-200 dark:border-slate-800">
                        <div class="flex items-start justify-between">
                            <div>
                                <p class="text-sm text-subtext-light font-medium mb-1">TOP SELLING MEDICINE</p>
                                <p class="text-2xl font-bold text-text-light dark:text-text-dark" id="topMedicine">N/A</p>
                                <div class="flex items-center mt-2 text-sm">
                                    <span class="material-icons text-base text-orange-600">inventory_2</span>
                                    <span class="ml-1 text-orange-600" id="topMedicineSales">0 units sold</span>
                                </div>
                            </div>
                            <div class="p-3 bg-orange-100 rounded-lg"><span class="material-icons text-orange-600" style="font-size:28px;">medication</span></div>
                        </div>
                    </div>
                </div>

                <!-- TABLES ROW -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                    <div class="bg-surface-light dark:bg-surface-dark p-6 rounded-xl border border-slate-200 dark:border-slate-800">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="font-semibold text-text-light dark:text-text-dark">Top Selling Medicines</h3>
                            <button onclick="salesManager.exportData('medicines')" class="text-primary text-sm font-medium hover:underline">Export</button>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm">
                                <thead><tr class="border-b border-slate-200 dark:border-slate-700">
                                    <th class="text-left pb-3 text-subtext-light font-medium">Medicine</th>
                                    <th class="text-right pb-3 text-subtext-light font-medium">Qty Sold</th>
                                    <th class="text-right pb-3 text-subtext-light font-medium">Revenue</th>
                                    <th class="text-right pb-3 text-subtext-light font-medium">Growth</th>
                                </tr></thead>
                                <tbody id="topMedicinesTable"></tbody>
                            </table>
                        </div>
                    </div>
                    <div class="bg-surface-light dark:bg-surface-dark p-6 rounded-xl border border-slate-200 dark:border-slate-800">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="font-semibold text-text-light dark:text-text-dark">Weekly Sales Performance</h3>
                            <button onclick="salesManager.exportData('weekly')" class="text-primary text-sm font-medium hover:underline">Export</button>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm">
                                <thead><tr class="border-b border-slate-200 dark:border-slate-700">
                                    <th class="text-left pb-3 text-subtext-light font-medium">Period</th>
                                    <th class="text-right pb-3 text-subtext-light font-medium">Revenue</th>
                                    <th class="text-right pb-3 text-subtext-light font-medium">Transactions</th>
                                    <th class="text-right pb-3 text-subtext-light font-medium">Avg. Order</th>
                                </tr></thead>
                                <tbody id="weeklySalesTable"></tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- CHARTS ROW -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                    <div class="bg-surface-light dark:bg-surface-dark p-6 rounded-xl border border-slate-200 dark:border-slate-800">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="font-semibold text-text-light dark:text-text-dark">Sales Trend</h3>
                            <button onclick="salesManager.exportData('trend')" class="text-primary text-sm font-medium hover:underline">Export Data</button>
                        </div>
                        <div class="h-64"><canvas id="salesTrendChart"></canvas></div>
                    </div>
                    <div class="bg-surface-light dark:bg-surface-dark p-6 rounded-xl border border-slate-200 dark:border-slate-800">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="font-semibold text-text-light dark:text-text-dark">Medicine Sales Distribution</h3>
                            <button onclick="salesManager.exportData('medicine-dist')" class="text-primary text-sm font-medium hover:underline">Export Data</button>
                        </div>
                        <div class="h-64"><canvas id="categoryChart"></canvas></div>
                    </div>
                </div>

                <!-- PHARMACIST PERFORMANCE -->
                <div class="bg-surface-light dark:bg-surface-dark p-6 rounded-xl border border-slate-200 dark:border-slate-800 mb-6">
                    <div class="flex items-center justify-between mb-4">
                        <div class="flex items-center gap-3">
                            <div class="w-10 h-10 bg-primary/10 rounded-lg flex items-center justify-center">
                                <span class="material-icons text-primary">people</span>
                            </div>
                            <div>
                                <h3 class="font-semibold text-text-light dark:text-text-dark">Pharmacist Performance</h3>
                                <p class="text-sm text-subtext-light">Individual performance metrics by pharmacist</p>
                            </div>
                        </div>
                        <button onclick="salesManager.exportData('pharmacist')" class="text-primary text-sm font-medium hover:underline">Export</button>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-sm">
                            <thead><tr class="border-b border-slate-200 dark:border-slate-700">
                                <th class="text-left pb-3 text-subtext-light font-medium">Pharmacist</th>
                                <th class="text-right pb-3 text-subtext-light font-medium">Transactions</th>
                                <th class="text-right pb-3 text-subtext-light font-medium">Revenue Generated</th>
                                <th class="text-right pb-3 text-subtext-light font-medium">Avg. Order Value</th>
                                <th class="text-right pb-3 text-subtext-light font-medium">Performance</th>
                            </tr></thead>
                            <tbody id="pharmacistPerformanceTable"></tbody>
                        </table>
                    </div>
                </div>

            </main>
        </div>
    </div>

<script>
    const API_BASE_URL = 'http://localhost:5001';

    // ── WINDOW CONTROLS ──
    document.getElementById('min-btn').addEventListener('click', () => { if (window.electronAPI) window.electronAPI.minimize(); });
    document.getElementById('max-btn').addEventListener('click', () => {
        if (window.electronAPI) { window.electronAPI.maximize(); }
        else { if (!document.fullscreenElement) { document.documentElement.requestFullscreen().catch(()=>{}); document.getElementById('maxIcon').textContent = 'filter_none'; } else { document.exitFullscreen(); document.getElementById('maxIcon').textContent = 'crop_square'; } }
    });
    document.getElementById('close-btn').addEventListener('click', () => {
        Swal.fire({ title:'Close Application?', icon:'question', showCancelButton:true, confirmButtonColor:'#005a32', confirmButtonText:'Yes, close' })
        .then(r => { if (r.isConfirmed) { sessionStorage.clear(); window.location.href = '../html/login.html'; } });
    });

    // ── LOGOUT (sidebar bottom) ──
    function logoutUser() {
        Swal.fire({
            title: "Logout?",
            icon: "warning",
            showCancelButton: true,
            confirmButtonColor: "#005a32",
            confirmButtonText: "Yes, logout"
        }).then(r => {
            if (r.isConfirmed) {
                sessionStorage.removeItem('userInfo');
                sessionStorage.removeItem('token');
                window.location.href = '../html/login.html';
            }
        });
    }

    function confirmBackToHMS(event) {
        event.preventDefault();
        Swal.fire({ title:"Leave Sales Reports?", text:"Return to IHMS?", icon:"question", showCancelButton:true, confirmButtonColor:"#005a32", confirmButtonText:"Yes, go back" })
        .then(r => { if (r.isConfirmed) window.location.href = '../html/index.html'; });
    }

    // ── NOTIFICATION SYSTEM ──
    let notifData = [
        { id:1, type:'shortage', unread:true, title:'Low Stock: Amoxicillin',    desc:'Inventory level dropped below 15% threshold (12 units remaining).', time:'2m ago',  actionLabel:'Restock Now',     actionClass:'btn-shortage', icon:'inventory_2',     iconClass:'icon-shortage' },
        { id:2, type:'expiry',   unread:true, title:'Expiring Soon: Lisinopril', desc:'Batch #L-S01 expires in 12 days. 5 units remaining in current stock.', time:'45m ago', actionLabel:'Review Batch',    actionClass:'btn-expiry',   icon:'event_busy',      iconClass:'icon-expiry'   },
        { id:3, type:'pending',  unread:true, title:'Pending Approval',          desc:'New supplier request from "PharmaGlobal Inc" needs verification.',    time:'2h ago',  actionLabel:'Review',          actionClass:'btn-pending',  icon:'pending_actions', iconClass:'icon-pending'  },
        { id:4, type:'critical', unread:true, title:'Critical: Out of Stock',    desc:'Metformin 850mg is completely out of stock. Patients are on waiting list.', time:'3h ago', actionLabel:'Emergency Order',actionClass:'btn-critical', icon:'warning',         iconClass:'icon-critical' }
    ];
    let activeNotifFilter = 'all';

    function renderNotifications() {
        const list = document.getElementById('notifList');
        const filtered = activeNotifFilter === 'all' ? notifData : notifData.filter(n => n.type === activeNotifFilter);
        if (!filtered.length) { 
            list.innerHTML = `<div class="notif-empty"><span class="material-icons">notifications_none</span><p>No notifications in this category</p></div>`; 
            updateNotifBadge(); 
            return; 
        }
        list.innerHTML = filtered.map(n => `
            <div class="notif-item ${n.type} ${n.unread ? 'unread' : ''}" id="notif-${n.id}" onclick="markNotifRead(${n.id})">
                <div class="notif-icon-wrap ${n.iconClass}"><span class="material-icons">${n.icon}</span></div>
                <div class="notif-body">
                    <div class="notif-title">${n.title}</div>
                    <div class="notif-desc">${n.desc}</div>
                    <div class="notif-time">${n.time}</div>
                    <div class="notif-action"><button class="notif-action-btn ${n.actionClass}" onclick="handleNotifAction(event,${n.id})">${n.actionLabel}</button></div>
                </div>
                ${n.unread ? '<div class="unread-dot"></div>' : ''}
            </div>`).join('');
        updateNotifBadge();
    }

    function updateNotifBadge() {
        const count = notifData.filter(n => n.unread).length;
        const badge = document.getElementById('notificationBadge');
        const pill  = document.getElementById('unreadPill');
        badge.textContent = count; 
        badge.style.display = count > 0 ? 'flex' : 'none';
        if (pill) pill.textContent = count > 0 ? `${count} new` : 'All read';
    }
    
    function markNotifRead(id) { 
        const n = notifData.find(n => n.id === id); 
        if (n) { n.unread = false; renderNotifications(); } 
    }
    
    function markAllRead() { 
        notifData.forEach(n => n.unread = false); 
        renderNotifications(); 
    }
    
    function handleNotifAction(event, id) { 
        event.stopPropagation(); 
        markNotifRead(id); 
        // Add action handling here
        Swal.fire({
            title: 'Action Triggered',
            text: `Processing action for notification #${id}`,
            icon: 'info',
            timer: 1500
        });
    }
    
    function filterNotifTab(btn, filter) { 
        document.querySelectorAll('.notif-tab-btn').forEach(b => b.classList.remove('active')); 
        btn.classList.add('active'); 
        activeNotifFilter = filter; 
        renderNotifications(); 
    }

    async function updateNotificationBadge() {
        try {
            const token = getToken(); 
            if (!token) return;
            const res = await fetch(`${API_BASE_URL}/api/inventory`, { headers: { 'Authorization': `Bearer ${token}` } });
            if (!res.ok) return;
            const inventory = await res.json();
            const today = new Date(), thirtyDays = new Date(); 
            thirtyDays.setDate(today.getDate() + 30);
            const alerts = [];
            inventory.forEach((item, idx) => {
                const medName = item.medicine ? (item.medicine.name || 'Unknown') : 'Unknown';
                if (item.expiryDate) { 
                    const expiry = new Date(item.expiryDate); 
                    if (expiry < today) { 
                        alerts.push({ id:`exp-${idx}`, type:'expiry', unread:true, title:'Medicine Expired', desc:`${medName} expired`, time:'Just now', actionLabel:'Review Batch', actionClass:'btn-expiry', icon:'event_busy', iconClass:'icon-expiry' }); 
                    } else if (expiry < thirtyDays) { 
                        const d = Math.ceil((expiry-today)/(864e5)); 
                        alerts.push({ id:`exp-${idx}`, type:'expiry', unread:true, title:'Expiring Soon', desc:`${medName} expires in ${d} days`, time:`${d} days left`, actionLabel:'Review Batch', actionClass:'btn-expiry', icon:'schedule', iconClass:'icon-expiry' }); 
                    } 
                }
                if (item.quantity === 0) { 
                    alerts.push({ id:`stk-${idx}`, type:'critical', unread:true, title:'Out of Stock', desc:`${medName} is out of stock`, time:'Immediate', actionLabel:'Emergency Order', actionClass:'btn-critical', icon:'warning', iconClass:'icon-critical' }); 
                }
                else if (item.quantity <= item.minStockLevel) { 
                    alerts.push({ id:`stk-${idx}`, type:'shortage', unread:true, title:'Low Stock', desc:`${medName} — only ${item.quantity} units`, time:'Reorder soon', actionLabel:'Restock Now', actionClass:'btn-shortage', icon:'inventory_2', iconClass:'icon-shortage' }); 
                }
            });
            notifData = alerts.slice(0, 10); 
            renderNotifications();
        } catch(e) { console.error('Notification error:', e); }
    }

    function getToken() {
        const userInfo = sessionStorage.getItem('userInfo');
        return userInfo ? JSON.parse(userInfo).token : null;
    }

    // ── SALES MANAGER ──
    class SalesDataManager {
        constructor() {
            this.salesTransactions = [];
            this.trendChart = null;
            this.catChart = null;
            this.currentStats = null;
            this.init();
        }

        async init() {
            if (this.getToken()) { 
                await this.fetchSalesData(); 
                this.setupEventListeners(); 
            }
            else { window.location.href = '../html/login.html'; }
        }

        getToken() {
            const userInfo = sessionStorage.getItem('userInfo');
            return userInfo ? JSON.parse(userInfo).token : null;
        }

        async apiCall(endpoint) {
            try {
                const res = await fetch(`${API_BASE_URL}${endpoint}`, { headers: { 'Authorization': `Bearer ${this.getToken()}` } });
                if (!res.ok) throw new Error('Failed');
                return await res.json();
            } catch(e) { console.error(e); return []; }
        }

        async fetchSalesData() {
            const salesData = await this.apiCall('/api/sales');
            if (salesData) {
                this.salesTransactions = [];
                salesData.forEach(sale => {
                    sale.items.forEach(item => {
                        const qty = parseInt(item.quantity) || 0;
                        const price = parseFloat(item.priceAtSale) || 0;
                        this.salesTransactions.push({
                            id: sale._id, date: sale.date.split('T')[0],
                            medicineName: item.name || 'Unknown',
                            category: this.getMedicineCategory(item.name || ''),
                            quantity: qty, revenue: qty * price,
                            pharmacist: sale.pharmacist ? sale.pharmacist.name : 'Unknown',
                            fullDate: new Date(sale.date)
                        });
                    });
                });
                this.updateSalesData('30');
            }
        }

        getMedicineCategory(name) {
            if (/Paracetamol|Ibuprofen|Aspirin|Pain/i.test(name)) return 'Pain Relief';
            if (/Amoxicillin|Cefalexin|Antibiotic/i.test(name)) return 'Antibiotics';
            if (/Metformin|Insulin|Diabetes/i.test(name)) return 'Diabetes';
            if (/Losartan|Amlodipine|Cardio/i.test(name)) return 'Cardiovascular';
            if (/Omeprazole|Antacid|Gastro/i.test(name)) return 'Gastrointestinal';
            if (/Vitamin|Supplement/i.test(name)) return 'Vitamins';
            return 'Others';
        }

        updateSalesData(timeRange) {
            const range = parseInt(timeRange);
            const now = new Date();
            const startDate = new Date(); startDate.setDate(now.getDate() - range);
            const prevStartDate = new Date(startDate); prevStartDate.setDate(prevStartDate.getDate() - range);
            const currentSales  = this.salesTransactions.filter(s => s.fullDate >= startDate);
            const previousSales = this.salesTransactions.filter(s => s.fullDate >= prevStartDate && s.fullDate < startDate);
            this.currentStats = this.analyzeSalesData(currentSales, previousSales);
            this.renderUI(this.currentStats);
        }

        analyzeSalesData(currentSales, previousSales) {
            const calcTotals = (sales) => {
                const revenue = sales.reduce((sum, s) => sum + (s.revenue || 0), 0);
                const transactions = new Set(sales.map(s => s.id)).size;
                return { revenue, transactions, avgOrder: transactions > 0 ? revenue / transactions : 0 };
            };
            const current = calcTotals(currentSales);
            const previous = calcTotals(previousSales);
            const calcGrowth = (curr, prev) => prev === 0 ? (curr > 0 ? 100 : 0) : ((curr - prev) / prev) * 100;
            const summary = {
                totalRevenue: current.revenue, revenueGrowth: calcGrowth(current.revenue, previous.revenue),
                totalTransactions: current.transactions, transactionsGrowth: calcGrowth(current.transactions, previous.transactions),
                avgOrderValue: current.avgOrder, avgOrderGrowth: calcGrowth(current.avgOrder, previous.avgOrder)
            };
            const getMedStats = (sales) => { const map = {}; sales.forEach(s => { if (!map[s.medicineName]) map[s.medicineName] = { rev:0, qty:0 }; map[s.medicineName].rev += s.revenue; map[s.medicineName].qty += s.quantity; }); return map; };
            const currMeds = getMedStats(currentSales);
            const prevMeds = getMedStats(previousSales);
            let bestSellerName = 'N/A', bestSellerQty = 0;
            Object.entries(currMeds).forEach(([name, data]) => { if (data.qty > bestSellerQty) { bestSellerQty = data.qty; bestSellerName = name; } });
            summary.topMedicineName = bestSellerName; summary.topMedicineQty = bestSellerQty;
            const topMedicines = Object.entries(currMeds).map(([name, data]) => ({ name, qtySold: data.qty, revenue: data.rev, growth: calcGrowth(data.rev, prevMeds[name] ? prevMeds[name].rev : 0) })).sort((a, b) => b.revenue - a.revenue).slice(0, 5);
            const sortedByQty = Object.entries(currMeds).sort((a, b) => b[1].qty - a[1].qty);
            const top5 = sortedByQty.slice(0, 5);
            const others = sortedByQty.slice(5);
            const distLabels = top5.map(i => i[0]);
            const distData   = top5.map(i => i[1].qty);
            if (others.length > 0) { distLabels.push('Others'); distData.push(others.reduce((s, i) => s + i[1].qty, 0)); }
            const pharmMap = {};
            currentSales.forEach(s => { if (!pharmMap[s.pharmacist]) pharmMap[s.pharmacist] = { trans: new Set(), rev: 0 }; pharmMap[s.pharmacist].trans.add(s.id); pharmMap[s.pharmacist].rev += s.revenue; });
            const pharmacistData = Object.entries(pharmMap).map(([name, d]) => ({ name, transactions: d.trans.size, revenue: d.rev, avgOrder: d.trans.size > 0 ? d.rev / d.trans.size : 0, performance: (d.rev / d.trans.size) > 500 ? 'Excellent' : 'Good' }));
            const grouping = {};
            currentSales.forEach(s => { if (!grouping[s.date]) grouping[s.date] = { rev:0, trans: new Set() }; grouping[s.date].rev += s.revenue; grouping[s.date].trans.add(s.id); });
            const labels = Object.keys(grouping).sort();
            const weeklySales = labels.map(date => ({ period: date, revenue: grouping[date].rev, transactions: grouping[date].trans.size, avgOrder: grouping[date].trans.size > 0 ? grouping[date].rev / grouping[date].trans.size : 0 })).slice(-7);
            return { summary, topMedicines, pharmacistPerformance: pharmacistData, weeklySales, chartData: { salesTrend: { labels, data: labels.map(d => grouping[d].rev) }, distChart: { labels: distLabels, data: distData } } };
        }

        renderUI(data) {
            const growthHtml = (val) => `<span class="${val >= 0 ? 'text-green-600' : 'text-red-600'}">${val >= 0 ? '↑' : '↓'} ${Math.abs(val).toFixed(1)}%</span>`;
            document.getElementById('totalRevenue').textContent = this.formatPeso(data.summary.totalRevenue);
            document.getElementById('revenueGrowth').innerHTML = `${growthHtml(data.summary.revenueGrowth)} from last period`;
            document.getElementById('totalTransactions').textContent = this.formatNumber(data.summary.totalTransactions);
            document.getElementById('transactionsGrowth').innerHTML = `${growthHtml(data.summary.transactionsGrowth)} from last period`;
            document.getElementById('avgOrderValue').textContent = this.formatPeso(data.summary.avgOrderValue);
            document.getElementById('avgOrderGrowth').innerHTML = `${growthHtml(data.summary.avgOrderGrowth)} from last period`;
            document.getElementById('topMedicine').textContent = data.summary.topMedicineName;
            document.getElementById('topMedicineSales').textContent = `${this.formatNumber(data.summary.topMedicineQty)} units sold`;
            this.renderTable('topMedicinesTable', data.topMedicines, (m) => `
                <td class="py-3 text-text-light dark:text-text-dark">${m.name}</td>
                <td class="py-3 text-right">${this.formatNumber(m.qtySold)}</td>
                <td class="py-3 text-right">${this.formatPeso(m.revenue)}</td>
                <td class="py-3 text-right font-medium">${growthHtml(m.growth)}</td>`);
            this.renderTable('weeklySalesTable', data.weeklySales, (w) => `
                <td class="py-3 text-text-light dark:text-text-dark">${w.period}</td>
                <td class="py-3 text-right">${this.formatPeso(w.revenue)}</td>
                <td class="py-3 text-right">${w.transactions}</td>
                <td class="py-3 text-right text-blue-600 font-medium">${this.formatPeso(w.avgOrder)}</td>`);
            this.renderTable('pharmacistPerformanceTable', data.pharmacistPerformance, (p) => `
                <td class="py-3 text-text-light dark:text-text-dark">${p.name}</td>
                <td class="py-3 text-right">${p.transactions}</td>
                <td class="py-3 text-right">${this.formatPeso(p.revenue)}</td>
                <td class="py-3 text-right">${this.formatPeso(p.avgOrder)}</td>
                <td class="py-3 text-right font-bold ${p.performance === 'Excellent' ? 'text-green-500' : 'text-blue-500'}">${p.performance}</td>`);
            this.renderCharts(data.chartData);
        }

        renderTable(id, data, rowTemplate) {
            const tbody = document.getElementById(id);
            tbody.innerHTML = data.length === 0
                ? '<tr><td colspan="5" class="py-4 text-center text-subtext-light">No data available</td></tr>'
                : data.map(item => `<tr class="border-b border-slate-100 dark:border-slate-800">${rowTemplate(item)}</tr>`).join('');
        }

        renderCharts(data) {
            const salesCtx = document.getElementById('salesTrendChart').getContext('2d');
            if (this.trendChart) this.trendChart.destroy();
            this.trendChart = new Chart(salesCtx, {
                type: 'line',
                data: { labels: data.salesTrend.labels, datasets: [{ label: 'Revenue', data: data.salesTrend.data, borderColor: '#005a32', backgroundColor: 'rgba(0,90,50,0.1)', fill: true, tension: 0.3 }] },
                options: { responsive: true, maintainAspectRatio: false }
            });
            const catCtx = document.getElementById('categoryChart').getContext('2d');
            if (this.catChart) this.catChart.destroy();
            this.catChart = new Chart(catCtx, {
                type: 'doughnut',
                data: { labels: data.distChart.labels, datasets: [{ data: data.distChart.data, backgroundColor: ['#005a32','#d62828','#8b5a2b','#10B981','#3B82F6','#8B5CF6'] }] },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'right', labels: { boxWidth: 12, font: { size: 10 } } } } }
            });
        }

        setupEventListeners() {
            document.getElementById('timeRange').addEventListener('change', (e) => this.updateSalesData(e.target.value));
            const exportBtn = document.getElementById('exportBtn');
            const exportOptions = document.getElementById('exportOptions');
            exportBtn.addEventListener('click', (e) => { e.stopPropagation(); exportOptions.style.display = exportOptions.style.display === 'block' ? 'none' : 'block'; });
            document.addEventListener('click', () => { exportOptions.style.display = 'none'; });
        }

        formatPeso(amount) { if (isNaN(amount) || amount === null) return '₱0.00'; return '₱' + amount.toLocaleString('en-PH', { minimumFractionDigits: 2 }); }
        formatNumber(num) { if (isNaN(num) || num === null) return '0'; return num.toLocaleString('en-PH'); }

        exportData(type) {
            if (!this.currentStats) return Swal.fire('No Data', 'Please wait for data to load.', 'warning');
            const timestamp = new Date().toISOString().split('T')[0];
            let filename = `WellServed_${timestamp}`, dataToExport = [], sheetName = 'Data';
            if (type === 'medicines')     { filename += '_TopMedicines'; sheetName = 'Top Medicines'; dataToExport = this.currentStats.topMedicines.map(m => ({ Medicine: m.name, 'Qty Sold': m.qtySold, Revenue: m.revenue, Growth: `${m.growth.toFixed(1)}%` })); }
            else if (type === 'weekly')   { filename += '_WeeklyPerf'; sheetName = 'Weekly Sales'; dataToExport = this.currentStats.weeklySales.map(w => ({ Period: w.period, Revenue: w.revenue, Transactions: w.transactions, 'Avg Order': w.avgOrder })); }
            else if (type === 'pharmacist') { filename += '_PharmPerf'; sheetName = 'Pharmacist'; dataToExport = this.currentStats.pharmacistPerformance.map(p => ({ Pharmacist: p.name, Transactions: p.transactions, Revenue: p.revenue, 'Avg Order': p.avgOrder, Rating: p.performance })); }
            else if (type === 'trend')    { filename += '_Trend'; sheetName = 'Sales Trend'; dataToExport = this.currentStats.chartData.salesTrend.labels.map((l, i) => ({ Date: l, Revenue: this.currentStats.chartData.salesTrend.data[i] })); }
            else if (type === 'medicine-dist') { filename += '_Dist'; sheetName = 'Distribution'; dataToExport = this.currentStats.chartData.distChart.labels.map((l, i) => ({ Medicine: l, 'Quantity Sold': this.currentStats.chartData.distChart.data[i] })); }
            else if (type === 'pdf')  return this.generatePDF(filename);
            else if (['excel','csv'].includes(type)) { filename += '_All'; dataToExport = this.salesTransactions.map(s => ({ Date: s.date, Medicine: s.medicineName, Category: s.category, Quantity: s.quantity, Revenue: s.revenue, Pharmacist: s.pharmacist })); }
            if (!dataToExport.length) return Swal.fire('Empty', 'No data for this export.', 'info');
            const ws = XLSX.utils.json_to_sheet(dataToExport);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, sheetName);
            XLSX.writeFile(wb, `${filename}.${type === 'csv' ? 'csv' : 'xlsx'}`);
            Swal.fire({ icon:'success', title:'Exported', text:`${filename} downloaded.`, timer:1500, showConfirmButton:false });
        }

        generatePDF(filename) {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            doc.setFillColor(0,90,50); doc.rect(0,0,210,20,'F');
            doc.setTextColor(255,255,255); doc.setFontSize(16); doc.text("Well Served Sales Report",14,13);
            doc.setTextColor(0,0,0); doc.setFontSize(10);
            doc.text(`Generated: ${new Date().toLocaleString()}`,14,30);
            doc.text(`Total Revenue: ${document.getElementById('totalRevenue').textContent}`,14,36);
            doc.autoTable({ head:[["Date","Medicine","Category","Qty","Revenue","Pharmacist"]], body: this.salesTransactions.map(s => [s.date, s.medicineName, s.category, s.quantity, this.formatPeso(s.revenue), s.pharmacist]), startY:45, theme:'grid', headStyles:{fillColor:[0,90,50]}, styles:{fontSize:8} });
            doc.save(`${filename}.pdf`);
        }
    }

    // Initialize everything when DOM loads
    document.addEventListener('DOMContentLoaded', function() {
        // Notification dropdown initialization
        const btn = document.getElementById('notificationBtn');
        const dropdown = document.getElementById('notificationDropdown');
        btn.addEventListener('click', (e) => { 
            e.stopPropagation(); 
            dropdown.classList.toggle('open'); 
        });
        document.addEventListener('click', (e) => { 
            if (!dropdown.contains(e.target)) dropdown.classList.remove('open'); 
        });
        dropdown.addEventListener('click', e => e.stopPropagation());
        
        // Render initial notifications
        renderNotifications();
        
        // Initialize sales manager
        salesManager = new SalesDataManager();
        window.salesManager = salesManager;
        
        // Start periodic updates
        setTimeout(updateNotificationBadge, 1000);
        setInterval(updateNotificationBadge, 30000);
    });

    // Export function for global access
    window.exportReport = (t) => salesManager.exportData(t);
</script>

<script src="../js/windowcontrollerbtn.js"></script>
</body>
</html>